extends ../layout
block css
	link(rel='stylesheet', href='/stylesheets/datepicker.css')
block content
	div(class="row")
		div(class="col-md-12")
			h2 Financeiro
		div(class="col-md-12")
			hr
		div(class="col-md-12")
			form(id="", method="POST", action="/financeiro", class="form-horizontal")
				label Usuário
					input(type="text", class="form-control", placeholder="OS/Nome/CPF", name="id_crypto")
				
				label busca
					select(class="form-control", name="status_id")
						option(value="0", selected="selected") Busca seletiva
						option(value="4") Aguardando Pagamento 
						option(value="5") Em Processamento 
						option(value="6") Aprovada 
						option(value="7") Cancelada 
						option(value="24") Em Contestação 
						option(value="87") Em Monitoramento 
						option(value="88") Em Recuperação 
						option(value="89") Reprovada 
				
				label Data Inicio
					input(type="text", class="form-control datepicker", placeholder="Data inicio", name="cpf")
				label Data Fim
					input(type="text", class="form-control datepicker", placeholder="Data fim", name="cpf")

				label
					input(type="submit", class="btn btn-success form-control", value="Buscar!")
				

		div(class="col-md-12")

			if financeiro
				div(class="table-responsive")
					table(class="table table-condensed table-striped table-hover table-bordered")
						thead
							tr
								th Senha 
								th CPF
								th E-mail
								//th Data
								th Status
								th TOKEN
								th 
						tbody
							each ref in financeiro
								if (ref.resposta)
									tr(class="#{classList}")
										td #{ref.id_crypto}
										td #{ref.referenciado.cpf}
										td #{ref.referenciado.email}
										//td #{ref.created_at}	 
										td #{ref.resposta.transaction.status_name}
										td #{ref.resposta.token_transaction}
										td
											div(class="btn-group")
												button(type="button", class="btn btn-primary dropdown-toggle btn-xs", data-toggle="dropdown") Ações  
													span(class="caret")
												ul(class="dropdown-menu pull-right")
													li
														a(href="#" class="semlinha") Enviar cobrança por email
													
													//- form(method="get", action="http://checkout.sandbox.tray.com.br/payment/transaction/#{ref.resposta.token_transaction}", target="_blank")
													//- 	input(type="hidden", name="token_account", value="7fe49d0444e9ba9")
													//- 	input(type="hidden", name="url_notification", value="http://directmed.herokuapp.com/financeiro/resposta")
													//- 	input(type="hidden", name="type_response", value="J")
													//- 	input(type="submit", class="btn btn-default btn-xs", name="submit", value="Finalizar Pagamento")
								else
									tr()
										td #{ref.id_crypto}
										td #{ref.referenciado.cpf}
										td #{ref.referenciado.email}
										//td #{ref.created_at}	 
										td 
										td 
										td
											div(class="btn-group")
												button(type="button", class="btn btn-primary dropdown-toggle btn-xs", data-toggle="dropdown") Ações  
													span(class="caret")
												ul(class="dropdown-menu pull-right")
													li
														a(href="#" class="semlinha") Enviar cobrança por email
													li
														a(href="#" class="semlinha") Visualizar
													li
														form(method="post", action="https://checkout.sandbox.tray.com.br/payment/transaction", target="_blank")
															input(type="hidden", name="token_account", value="7fe49d0444e9ba9void")
															input(type="hidden", name="transaction_product[][description]", value="Cadastro DirectMed")
															input(type="hidden", name="transaction_product[][quantity]", value="1")
															input(type="hidden", name="transaction_product[][price_unit]", value="40.00")
															input(type="hidden", name="order_number", value="#{ref.id_crypto}")
															input(type="hidden", name="url_notification", value="http://directmed.herokuapp.com/financeiro/resposta")
															input(type="hidden", name="type_response", value="J")
														a(class="semlinha", href="#") Pagar!!

				ul(class="pagination pagination-sm pull-right")
					li(class="disabled")
						a(href="#") «
					li(class="active")
						a(href="#") 1
					li()
						a(href="#") 2
					li()
						a(href="#") 3
					//class="disabled"
					li()
						a(href="#") 4
					li()
						a(href="#") »

			else
				h4 Nenhum cadastro.
block script
	script(src="/javascripts/bootstrap-datepicker.js")
	script(src="/javascripts/data.js")

